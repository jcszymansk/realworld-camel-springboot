<route id="direct_updateArticle"
  routeConfigurationId="verify-login,generic-error"
  xmlns="http://camel.apache.org/schema/spring">

  <from uri="direct:updateArticle" />

  <marshal><json /></marshal>
  <unmarshal><json unmarshalType="java.util.Map" /></unmarshal>

  <setProperty name="updateArticle"><simple>${body[article]}</simple></setProperty>

  <to uri="direct:findArticle" />

  <to uri="direct:verifyArticleAuthor" />

  <script><groovy><![CDATA[
    exchange.properties.updateArticle.each {
      if (it.value != null && !it.value.blank) { request.body."${it.key}" = it.value }
    }
  ]]></groovy></script>

  <to uri="jpa:com.github.jacekszymanski.realcamel.entity.Article" />

  <to uri="direct:returnArticle" />

</route>
